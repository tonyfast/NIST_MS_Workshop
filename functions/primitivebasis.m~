% function DMS = primitivebasis( A, bins )
% DMS is the output digital microstructure signal

% number of dimensions in the dataset
nd = ndims( A );
% number of bins
nb = numel( bins );

DSP = zeros( horzcat( size(A), nb ) );

DSP(:) = bsxfun( @minus, A, permute([ 
